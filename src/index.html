<!DOCTYPE html>

<html lang="en">

<head>

    <meta charset="UTF-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>WebSocker Client</title>

</head>

<body>

    <button onclick="contactServer()">Click Here</button>
    <div id="message-container"></div>

</body>

<script>

    // const socket = new WebSocket('ws://co2eq.herokuapp.com');
    const socket = new WebSocket('ws://localhost:8000');

    socket.addEventListener('open', function (event) {
        console.log("Connected to Socket");
    });

    function contactServer() {
        socket.send(JSON.stringify({ 
            'name' : 'IETF_150', 
            'location' : { 
                'country' : 'DE', 
                'city' : 'BER',
                'iata' : "BER",
            },
            'attendee_list': [                 
                {  
                "country": "NP" 
                }, 
                { 
                "country": "JP"                       
                },
                {
                "country": "NZ"
                },
                {
                "country": "UK"
                },
                {
                "country": "FR"
                },
                {
                "country": "UK" 
                },
                {
                "country": "UK" 
                },
                {
                "country": "UK" 
                }
            ]                                    
        }));
    }

    socket.addEventListener('message', function (event) {
        console.log("asd");
        var messageContainer = document.getElementById('message-container');
        messageContainer.appendChild(createImageMessageDOM(event.data))
    });

    function createImageMessageDOM(data) {
        var img = document.createElement("img");
        img.src = 'data:image/svg+xml;base64,' + data;    
        console.log(img.src)
        return img;
    }

</script>
